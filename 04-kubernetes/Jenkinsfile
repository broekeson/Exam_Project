pipeline {
 agent any

 environment {
    KUBECONFIG = '/var/lib/jenkins/workspace/altschool/01-terraform/kubeconfig.yaml'
  stages {
    stage('authenticate'){
       steps {
        script {
          def config = loadKubeConfig(env.KUBECONFIG)
          sh '''
          curl https://raw.githubusercontent.com/helm/helm/master/scripts/get-helm-3 | bash --kubeconfig=$env.KUBECONFIG
          helm repo add ingress-nginx https://kubernetes.github.io/ingress-nginx
          helm repo update
          helm install nginx-ingress ingress-nginx/ingress-nginx --kubeconfig=$env.KUBECONFIG
          '''
        }
    }
  }
 } 
}
}